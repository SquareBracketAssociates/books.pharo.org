<!DOCTYPE html>
<html>
  <head>
    <title></title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="shortcut icon" href="images/favicon.png" type="image/x-icon" />
<link href="/booklet-Smacc/html/_support/html/css/font-awesome.min.css" rel="stylesheet">
<link href="/booklet-Smacc/html/_support/html/css/nucleus.css" rel="stylesheet">
<link href="/booklet-Smacc/html/_support/html/css/flex.css" rel="stylesheet">
<link rel="stylesheet" href="/booklet-Smacc/html/_support/html/highlightjs/styles/default.css">
<link rel="stylesheet" href="/booklet-Smacc/html/_support/html/css/highlight-commands.css">
<link rel="stylesheet" href="/booklet-Smacc/html/_support/html/css/bootstrap.min.css">
<script src="/booklet-Smacc/html/_support/html/js/jquery-2.x.min.js"></script>
<script src="/booklet-Smacc/html/_support/html/highlightjs/highlight.pack.js"></script>
<script src="/booklet-Smacc/html/_support/html/js/highlight-commands.js"></script>
<meta name="description" content="">
<meta name="author" content="John Brant, Jason Lecerf,  Thierry Goubier, StÃ©phane Ducasse, and Andrew Black">
  </head>
  <body>
    <header>
  <div class="logo">
    <a class="baselink" href="/booklet-Smacc/html"></a>
  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
  
</header>
<article>
  <aside>
    <ul class="menu">
   		<li data-nav-id="123" class="dd-item">
    		<a href="/booklet-Smacc/html">
		       <i class="fa fa-fw fa-home"></i>
	    	</a>
        </li>

		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccIntro.html#about this booklet">
					About this Booklet
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccIntro.html#contents">
							Contents
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccIntro.html#obtaining smacc">
							Obtaining SmaCC
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccIntro.html#basics">
							Basics
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#a first smacc tutorial">
					A First SmaCC Tutorial
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#opening the tools">
							Opening the Tools
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item  haschildren ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#first, the scanner">
							First, the Scanner
						</a>
						<i class="fa fa-angle-right fa-lg category-icon"></i>
					</div>

					<ul class="dd-item">
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#ignoring whitespace">Ignoring Whitespace</a>
						</li>
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#second, the calculator grammar">
							Second, the Calculator Grammar
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#compile the scanner and the parser">
							Compile the Scanner and the Parser
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#testing our parser">
							Testing our Parser
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#defining actions">
							Defining Actions
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#named expressions">
							Named Expressions
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#extending the language">
							Extending the Language
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#handling priority">
							Handling Priority
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#handling priority with directives">
							Handling Priority with Directives
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccScanner.html#smacc scanner">
					SmaCC Scanner
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccScanner.html#regular expression syntax">
							Regular Expression Syntax
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccScanner.html#overlapping tokens">
							Overlapping Tokens
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccScanner.html#token action methods">
							Token Action Methods
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccScanner.html#unreferenced tokens">
							Unreferenced Tokens
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccScanner.html#unicode characters">
							Unicode Characters
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccParser.html#smacc parser">
					SmaCC Parser
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccParser.html#production rules">
							Production Rules
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccParser.html#named symbols">
							Named Symbols
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccParser.html#error recovery">
							Error Recovery
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccParser.html#shortcuts">
							Shortcuts
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccDirectives.html#smacc directives">
					SmaCC Directives
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccDirectives.html#start symbols">
							Start Symbols
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccDirectives.html#id methods">
							Id Methods
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccDirectives.html#case insensitive scanning">
							Case Insensitive Scanning
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccDirectives.html#ast directives">
							AST Directives
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item  haschildren ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccDirectives.html#dealing with ambiguous grammars">
							Dealing with Ambiguous Grammars
						</a>
						<i class="fa fa-angle-right fa-lg category-icon"></i>
					</div>

					<ul class="dd-item">
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccDirectives.html#lr, lalr and ambiguous grammars">LR, LALR and Ambiguous Grammars</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccDirectives.html#precedence rules">Precedence Rules</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccDirectives.html#glr parsing">GLR Parsing</a>
						</li>
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAST.html#smacc abstract syntax trees">
					SmaCC Abstract Syntax Trees
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAST.html#restarting">
							Restarting
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAST.html#building nodes ">
							Building Nodes 
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAST.html#variables and unnamed entities">
							Variables and Unnamed Entities
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAST.html#unnamed symbols">
							Unnamed Symbols
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAST.html#generating the ast">
							Generating the AST
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAST.html#ast comparison">
							AST Comparison
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAST.html#extending the visitor">
							Extending the Visitor
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#advanced features of smacc">
					Advanced Features of SmaCC
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#multi-state scanners">
							Multi-state Scanners
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item  haschildren ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#indentation-sensitive parsing">
							Indentation-Sensitive Parsing
						</a>
						<i class="fa fa-angle-right fa-lg category-icon"></i>
					</div>

					<ul class="dd-item">
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#using token actions to customize the scanner">Using Token Actions to Customize the Scanner</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#using newlines to separate statements">Using Newlines to Separate Statements</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#augmenting the state of the scanner">Augmenting the State of the Scanner</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#unnamed tokens">Unnamed Tokens</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#closing blocks">Closing Blocks</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#continuation lines">Continuation Lines</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#ignoring blank lines">Ignoring Blank Lines</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#the rest of the story">The Rest of the Story</a>
						</li>
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTransformations.html#smacc transformations">
					SmaCC Transformations
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTransformations.html#defining transformations ">
							Defining Transformations 
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTransformations.html#pattern matching expressions">
							Pattern matching Expressions
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTransformations.html#example">
							Example
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTransformations.html#parametrizing transformations">
							Parametrizing Transformations
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTransformations.html#restrictions and limitations">
							Restrictions and Limitations
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccIdioms.html#grammar idioms">
					Grammar Idioms
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccIdioms.html#managing lists">
							Managing Lists
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccIdioms.html#using shortcuts">
							Using Shortcuts
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccIdioms.html#expressing optional features">
							Expressing Optional Features
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccConclusion.html#conclusion">
					Conclusion
			  </a>
			  
			</div>
			  <ul class="dd-item">
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccVocabulary.html#vocabulary">
					Vocabulary
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccVocabulary.html#reference example ">
							Reference Example 
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccVocabulary.html#metagrammar structure">
							Metagrammar structure
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item  haschildren ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccVocabulary.html#elements ">
							Elements 
						</a>
						<i class="fa fa-angle-right fa-lg category-icon"></i>
					</div>

					<ul class="dd-item">
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccVocabulary.html#production rule">Production rule</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccVocabulary.html#tokens">Tokens</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccVocabulary.html#keywords">Keywords</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccVocabulary.html#non terminal">Non Terminal</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccVocabulary.html#variables">Variables</a>
						</li>
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
    </ul>
  </aside>

  <section class="page">
    
	<h1>Smacc: a Compiler-Compiler</h1>
		
	<h2>SmaCC Directives</h2>

<p>
SmaCC has several directives that can change how the scanner and parser is generated.
Each directive begins with a <code>%</code> character and the directive keyword.
Depending on the directive, there may be a set of arguments.
Finally, the directive is terminated with a semicolon character, <code>;</code> as shown below:
</p>
<figure><pre><code>%left &quot;+&quot; &quot;-&quot;;
%left &quot;*&quot; &quot;/&quot;;
%right &quot;^&quot;;
%annotate_tokens;
%root Expression;
%prefix AST;
%suffix Node;
%ignore_variables leftParenToken rightParenToken;</code></pre><figcaption></figcaption></figure>


<h3>Start Symbols</h3>

<p>
By default, the left-hand side of the first grammar rule is the start symbol.
If you want to multiple start symbols, you can specify them by using the <code>%start</code> directive followed by the nonterminals that are additional start symbols. 
This is useful for creating two parsers with grammars that are similar but slightly different.
For example, consider a Pharo parser.
You can parse methods, and you can parse expressions.
These are two different operations, but have similar grammars.
Instead of creating two different parsers for parsing methods and expressions, we can specify one grammar that parses methods, and also specify an alternative start symbol for parsing expressions.
</p>
<p>
The <code>StParser</code> in the SmaCC Example Parsers package has an example of this.
The method <code>StParser class&gt;&gt;parseMethod:</code> uses the <code>startingStateForMethod</code> position to parse methods and the method <code>StParser class&gt;&gt;parseExpression:</code> uses the <code>startingStateForSequenceNode</code> position to parse expressions.
</p>
<p>
For example if you add the following to an hypothetical grammar:
</p>
<figure><pre><code>%start file expression statement declaration;</code></pre><figcaption></figcaption></figure>

<p>
SmaCC will generate the following class methods on the parser: <code>startingStateForfile</code>, <code>startingStateForexpression</code>, <code>startingStateForstatement</code> and <code>startingStateFordeclaration</code>.
Then you can parse a subpart as follows:
</p>
<figure><pre><code>YourParser &gt;&gt; parseStatement: aString
	&quot;Parse an statement.&quot;

	^ (self on: (ReadStream on: aString))
		setStartingState: self startingStateForstatement;
		parse</code></pre><figcaption></figcaption></figure>

<p>
The ability to specify multiple start symbols is useful when you build your grammar incrementally.
You might also want to create additionnal start symbols to test grammar features independently.
</p>

<h3>Id Methods</h3>

<p>
Internally, the various token types are represented as integers.
However, there are times when you need to reference the token types.
For example, in the CScanner and CParser classes, the <code>TYPE_NAME</code> token has a syntax identical in the IDENTIFIER token.
To distinguish them, the IDENTIFIER matching method does a lookup in the type table: if it finds a type definition with the same name as the current IDENTIFIER, it returns the TYPE_NAME token type.
To determine what integer this is, the parser includes an <code>%id</code> directive for &lt;IDENTIFIER&gt; and &lt;TYPE_NAME&gt;.
This generates the IDENTIFIERId and TYPE_NAMEId methods on the scanner.
These methods simply return the integer representing that token type.
See the C sample scanner and parser for an example of how the <code>%id</code> directive is used.
</p>

<h3>Case Insensitive Scanning</h3>

<p>
You can specify that the scanner should ignore case differences by using the <code>%ignorecase;</code> directive.
If you have a language that is case insensitive and has several keywords, this can be a handy feature.
For example, if you have <code>THEN</code> as a keyword in a case insensitive language, you would need to specify the token for then as <code>&lt;then&gt; : [tT] [hH] [eE] [nN] ;</code>.
This is a pain to enter correctly.
When the ignorecase directive is used, SmaCC will automatically convert <code>THEN</code> into <code>[tT][hH][eE][nN]</code>.
</p>

<h3>AST Directives</h3>

<p>
There are several directives that are used when creating AST's. 
</p>
<p>
The <code>%root</code> directive is used to specify the root class in the AST hierarchy.
The <code>%root</code> directive has a single argument that is the name that will be used to create the root class in the AST.
This class will be created as a subclass of <code>SmaCCParseNode</code>.
</p>
<p>
The <code>%prefix</code> and <code>%suffix</code> directives tell SmaCC the prefix and suffix to add to create the node name for the AST node's class.
This prefix and suffix are added to the name of every AST node, including the %root node.
For example, the following will create a <code>RBProgramNode</code> class that is a subclass of <code>SmaCCParseNode</code> and is the root of all AST nodes defined by this parser.
</p>
<figure><pre><code>%root Program;
%prefix RB;
%suffix Node;</code></pre><figcaption></figcaption></figure>

<p>
By default all nodes created by SmaCC will be direct subclass of your <code>%root class</code>.
However, you can specify the class hierarchy by using the <code>%hierarchy</code> directive.
The syntax of the <code>%hierarchy</code> is <code>%hierarchy SuperclassName &quot;(&quot; SubclassName + &quot;);&quot;</code>.
If you have multiple subclasses, you can list all of them inside the parenthesis, separated by whitespace, as follows.
</p>
<figure><pre><code>%hierarchy Program (Expression Statement);</code></pre><figcaption></figcaption></figure>

<p>
Three AST directives deal with the generated classes' instance variables.
</p>
<p>
The <code>%annotate_tokens</code> tells SmaCC to generate instance variable names for any unnamed tokens in the grammar rules.
Without this directive, an unnamed token will generate the warning:
</p>
<figure><pre><code>Unnamed symbol in production. Without a variable name the value will be dropped from the parsed AST.&quot;</code></pre><figcaption></figcaption></figure>

<p>
With the directive, a variable name will be auto-generated, using the name of the symbol follwed by <code>Token</code>.
So the symbol <code>&lt;op&gt;</code> would be given the name <code>&lt;opToken&gt;</code>.
</p>

<p>
The <code>%attributes</code> directive allows you to add some extra instance variables to your classes.
This enables you to later extend the generated classes to use those variables.
The first argument to the <code>%attributes</code> directive is the node name (without the prefix and suffix); the second argument is a parenthesised list of variable names.
For example, we could add an instance variable <code>cachedValue</code> to the <code>Expression</code> class with <code>%attributes Expression (cachedValue);</code>.
</p>
<p>
Note that if you do not use this directive, but simply add the instance variables to the classes by hand, SmaCC will remove them the next time that the classes are re-generated.
Then your instance variables will become undeclared, and any code that uses them will start to behave unexpectedly.
This can be the explanation for unexplained and inconsistent behaviour.
</p>

<p>
The final instance variable directive is <code>%ignore_variables</code>. 
When SmaCC creates the AST node classes, it automatically generates appropriate <code>=</code> and <code>hash</code> methods.
By default, these methods use all instance variables when comparing for equality and computing the hash.
The <code>%ignore_variables</code> directive allows you to specify that certain variables should be ignored.
For example, you may wish to ignore parentheses when you compare expressions.
If you named your <code>(</code> token 'leftParen' and your <code>)</code> token 'rightParen', then you can specify this with <code>%ignore_variables leftParen rightParen;</code>.
</p>

<h3>Dealing with Ambiguous Grammars</h3>

<p>
An ambiguity occurs in a grammar when for a single lookahead token, the parser can execute two or more different actions.
Which one should the parser choose?
</p>
<p>
In traditionnal LR parsing, there are two types of conflicts between two actions that can occur: reduce/reduce and shift/reduce.
A reduce/reduce conflict exists when the parser can either reduce using one rule in the grammar or reduce using another rule.
A shift/reduce conflict exists when the parser can either shift the current lookahead token or reduce using a given rule.
</p>

<h4>LR, LALR and Ambiguous Grammars</h4>

<p>
When a LR or LALR parser is generated from an ambiguous grammar, conflicts will be displayed in the &quot;Message&quot; box.
The resulting parser will choose an arbitrary action to execute between the ones available.
Since it not a behaviour you usually want, you have several options: 
</p><ul>
<li>rewrite the grammar to be unambiguous,</li>
<li>hack in the parser/scanner to resolve the conflict,</li>
<li>use precedence rules to remove the confict (see section <a href="#PrecedenceRules"></a>),</li>
<li>switch to GLR parsing (see section <a href="#GLR"></a>).</li>
</ul>

<p>
The last two options will be detailed in the following sections.
</p>

<h4>Precedence Rules</h4>
<a id="PrecedenceRules"></a>
<p>
When SmaCC encounters a shift/reduce conflict it will perform the shift action by default.
However, you can control this action with the <code>%left</code>, <code>%right</code>, and <code>%nonassoc</code> directives.
If a token has been declared in a <code>%left</code> directive, it means that the token is left-associative.
Therefore, the parser will perform a reduce operation.
However, if it has been declared as right-associative, it will perform a shift operation.
A token defined as <code>%nonassoc</code> will produce an error if that is encountered during parsing.
For example, you may want to specify that the equal operator, &quot;=&quot;, is non-associative, so <code>a = b = c</code> is not parsed as a valid expression.
All three directives are followed by a list of tokens.
</p>
<p>
Additionally, the <code>%left</code>, <code>%right</code>, and <code>%nonassoc</code> directives allow precedence to be specified.
The order of the directives specifies the precedence of the tokens.
The higher precedence tokens appear on the higher line numbers.
For example, the following directive section gives the precedence for the simple calculator in our tutorial:
</p>
<figure><pre><code>%left &quot;+&quot; &quot;-&quot;;
%left &quot;*&quot; &quot;/&quot;;
%right &quot;^&quot;;</code></pre><figcaption></figcaption></figure>

<p>
The symbols <code>+</code> and <code>-</code> appear on the first line, and hence have the lowest precedence.
They are also left-associative, so <code>1 + 2 + 3</code> will be evaluated as <code>(1 + 2) + 3</code>.
On the next line we see the symbols <code>*</code> and <code>/</code>; since they appear on a line with a higher line number, they have higher precedence than <code>+</code> and <code>-</code>.
Finally, on line three we have the <code>^</code> symbol.
It has the highest precedence, but is <em>right</em> associative.
Combining all the rules allows us to parse <code>1 + 2 * 3 / 4 ^ 2 ^ 3</code> as <code>1 + ((2 * 3) / (4 ^ (2 ^ 3)))</code>.
</p>

<h4>GLR Parsing</h4>
<a id="GLR"></a>
<p>
SmaCC allows you to parse ambiguous grammars using a GLR parser.
The <code>%glr;</code> directive changes the type of parser that SmaCC generates (you can also used <code>%parser glr;</code>).
Instead of your generated parser being a subclass of <code>SmaCCParser</code>, when you use the <code>%glr;</code> directive, your parser will be a subclass of SmaCCGLRParser.
</p>
<p>
If you parse a string that has multiple representations, SmaCC will throw a <code>SmaCCAmbiguousResultNotification</code> exception, which can be handled by user code.
This exception has the potential parses.
The value with which it is resumed with will be selected as the definitive parse value.
If the exception is not handled, then SmaCC will pick one as the definitive parse value.
</p>
<p>
To handle all the ambiguities of a program, the GLR parser performs multiple parses in parallel.    
No individual parse backtracks, but when switching between parses the scanner may backtrack.                   
To support this, the scanner implements the methods <code>currentState</code> (which reifies the scanner's state into an object) and <code>restoreState:</code> (which expects as its parameter an object produced by <code>currentState</code>).
If you have added instance variables to your scanner, then you will need to override these two methods to save and restore your instance variables.                                                                   
The same is true for the parser: you can save and restore its state using the <code>duplicateState</code> and <code>restoreState:</code> methods respectively.
Be sure to override those methods if you have special instance variables in your parser.
</p>
<p>
If you have overlapping tokens, and have overridden the method <code>tryAllTokens</code> to return <code>true</code>, then in a GLR parser, SmaCC will try to perform a separate parse with each possible interpretation of the token.
In this case, SmaCC may defer a parser action until it has decided which interpretation to pursue.
Normally, this deferral will not be noticeable, but if the parser actions affect the scanner state, the scanner's behaviour will be changed.
This is likely to happen if your scanner has multiple states.
</p>


  </section>

</article>

<footer>

<div class="footline">
    <div class="github-link">
      <a href="" target="blank"><i class="fa fa-code-fork"></i>Github</a>
    </div>
  </div>
</footer>

<script src="/booklet-Smacc/html/_support/html/js/clipboard.min.js"></script>

<link href="/booklet-Smacc/html/_support/html/css/featherlight.min.css" rel="stylesheet">
<script src="/booklet-Smacc/html/_support/html/js/featherlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script src="/booklet-Smacc/html/_support/html/js/flex.js"></script>
<!-- Prettify annotated paragraphs-->
    <script src="/booklet-Smacc/html_support/html/js/annotated-paragraphs.js"></script>

  </body>
</html>
