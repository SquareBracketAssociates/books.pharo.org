<!DOCTYPE html>
<html>
  <head>
    <title></title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link rel="shortcut icon" href="images/favicon.png" type="image/x-icon" />
<link href="/booklet-Smacc/html/_support/html/css/font-awesome.min.css" rel="stylesheet">
<link href="/booklet-Smacc/html/_support/html/css/nucleus.css" rel="stylesheet">
<link href="/booklet-Smacc/html/_support/html/css/flex.css" rel="stylesheet">
<link rel="stylesheet" href="/booklet-Smacc/html/_support/html/highlightjs/styles/default.css">
<link rel="stylesheet" href="/booklet-Smacc/html/_support/html/css/highlight-commands.css">
<link rel="stylesheet" href="/booklet-Smacc/html/_support/html/css/bootstrap.min.css">
<script src="/booklet-Smacc/html/_support/html/js/jquery-2.x.min.js"></script>
<script src="/booklet-Smacc/html/_support/html/highlightjs/highlight.pack.js"></script>
<script src="/booklet-Smacc/html/_support/html/js/highlight-commands.js"></script>
<meta name="description" content="">
<meta name="author" content="John Brant, Jason Lecerf,  Thierry Goubier, StÃ©phane Ducasse, and Andrew Black">
  </head>
  <body>
    <header>
  <div class="logo">
    <a class="baselink" href="/booklet-Smacc/html"></a>
  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
  
</header>
<article>
  <aside>
    <ul class="menu">
   		<li data-nav-id="123" class="dd-item">
    		<a href="/booklet-Smacc/html">
		       <i class="fa fa-fw fa-home"></i>
	    	</a>
        </li>

		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccIntro.html#about this booklet">
					About this Booklet
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccIntro.html#contents">
							Contents
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccIntro.html#obtaining smacc">
							Obtaining SmaCC
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccIntro.html#basics">
							Basics
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#a first smacc tutorial">
					A First SmaCC Tutorial
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#opening the tools">
							Opening the Tools
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item  haschildren ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#first, the scanner">
							First, the Scanner
						</a>
						<i class="fa fa-angle-right fa-lg category-icon"></i>
					</div>

					<ul class="dd-item">
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#ignoring whitespace">Ignoring Whitespace</a>
						</li>
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#second, the calculator grammar">
							Second, the Calculator Grammar
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#compile the scanner and the parser">
							Compile the Scanner and the Parser
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#testing our parser">
							Testing our Parser
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#defining actions">
							Defining Actions
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#named expressions">
							Named Expressions
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#extending the language">
							Extending the Language
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#handling priority">
							Handling Priority
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTutorial.html#handling priority with directives">
							Handling Priority with Directives
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccScanner.html#smacc scanner">
					SmaCC Scanner
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccScanner.html#regular expression syntax">
							Regular Expression Syntax
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccScanner.html#overlapping tokens">
							Overlapping Tokens
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccScanner.html#token action methods">
							Token Action Methods
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccScanner.html#unreferenced tokens">
							Unreferenced Tokens
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccScanner.html#unicode characters">
							Unicode Characters
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccParser.html#smacc parser">
					SmaCC Parser
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccParser.html#production rules">
							Production Rules
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccParser.html#named symbols">
							Named Symbols
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccParser.html#error recovery">
							Error Recovery
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccParser.html#shortcuts">
							Shortcuts
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccDirectives.html#smacc directives">
					SmaCC Directives
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccDirectives.html#start symbols">
							Start Symbols
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccDirectives.html#id methods">
							Id Methods
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccDirectives.html#case insensitive scanning">
							Case Insensitive Scanning
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccDirectives.html#ast directives">
							AST Directives
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item  haschildren ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccDirectives.html#dealing with ambiguous grammars">
							Dealing with Ambiguous Grammars
						</a>
						<i class="fa fa-angle-right fa-lg category-icon"></i>
					</div>

					<ul class="dd-item">
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccDirectives.html#lr, lalr and ambiguous grammars">LR, LALR and Ambiguous Grammars</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccDirectives.html#precedence rules">Precedence Rules</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccDirectives.html#glr parsing">GLR Parsing</a>
						</li>
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAST.html#smacc abstract syntax trees">
					SmaCC Abstract Syntax Trees
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAST.html#restarting">
							Restarting
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAST.html#building nodes ">
							Building Nodes 
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAST.html#variables and unnamed entities">
							Variables and Unnamed Entities
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAST.html#unnamed symbols">
							Unnamed Symbols
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAST.html#generating the ast">
							Generating the AST
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAST.html#ast comparison">
							AST Comparison
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAST.html#extending the visitor">
							Extending the Visitor
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#advanced features of smacc">
					Advanced Features of SmaCC
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#multi-state scanners">
							Multi-state Scanners
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item  haschildren ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#indentation-sensitive parsing">
							Indentation-Sensitive Parsing
						</a>
						<i class="fa fa-angle-right fa-lg category-icon"></i>
					</div>

					<ul class="dd-item">
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#using token actions to customize the scanner">Using Token Actions to Customize the Scanner</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#using newlines to separate statements">Using Newlines to Separate Statements</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#augmenting the state of the scanner">Augmenting the State of the Scanner</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#unnamed tokens">Unnamed Tokens</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#closing blocks">Closing Blocks</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#continuation lines">Continuation Lines</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#ignoring blank lines">Ignoring Blank Lines</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccAdvanced.html#the rest of the story">The Rest of the Story</a>
						</li>
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTransformations.html#smacc transformations">
					SmaCC Transformations
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTransformations.html#defining transformations ">
							Defining Transformations 
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTransformations.html#pattern matching expressions">
							Pattern matching Expressions
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTransformations.html#example">
							Example
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTransformations.html#parametrizing transformations">
							Parametrizing Transformations
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccTransformations.html#restrictions and limitations">
							Restrictions and Limitations
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccIdioms.html#grammar idioms">
					Grammar Idioms
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccIdioms.html#managing lists">
							Managing Lists
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccIdioms.html#using shortcuts">
							Using Shortcuts
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccIdioms.html#expressing optional features">
							Expressing Optional Features
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccConclusion.html#conclusion">
					Conclusion
			  </a>
			  
			</div>
			  <ul class="dd-item">
				
			  </ul>
		  
		  </li>
		
		  <li class="dd-item  haschildren ">
			<div>
			  <a href="/booklet-Smacc/html/Chapters/Smacc/SmaccVocabulary.html#vocabulary">
					Vocabulary
			  </a>
			   <i class="fa fa-angle-right fa-lg category-icon"></i> 
			</div>
			  <ul class="dd-item">
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccVocabulary.html#reference example ">
							Reference Example 
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccVocabulary.html#metagrammar structure">
							Metagrammar structure
						</a>
						
					</div>

					<ul class="dd-item">
					
					</ul>						
				</li>
				
		   	  	<li class="dd-item  haschildren ">
					<div>
						<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccVocabulary.html#elements ">
							Elements 
						</a>
						<i class="fa fa-angle-right fa-lg category-icon"></i>
					</div>

					<ul class="dd-item">
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccVocabulary.html#production rule">Production rule</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccVocabulary.html#tokens">Tokens</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccVocabulary.html#keywords">Keywords</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccVocabulary.html#non terminal">Non Terminal</a>
						</li>
							
						<li class="dd-item">
							<a href="/booklet-Smacc/html/Chapters/Smacc/SmaccVocabulary.html#variables">Variables</a>
						</li>
					
					</ul>						
				</li>
				
			  </ul>
		  
		  </li>
		
    </ul>
  </aside>

  <section class="page">
    
	<h1>Smacc: a Compiler-Compiler</h1>
		
	<h2>A First SmaCC Tutorial</h2>

<p>
This tutorial demonstrates the basic features of SmaCC, the Smalltalk Compiler Compiler. 
We will use SmaCC to create a simple calculator. 
This tutorial was originally developed by Don Roberts and John Brant, and later modified 
by T. Goubier, S. Ducasse, J. Lecerf and Andrew Black.
</p>

<h3>Opening the Tools</h3>
<p>
Once you have loaded the code of SmaCC, you should open the SmaCC Parser Generator tool (Figure <a href="#SmaCCGUI"></a>). 
In Pharo, you can do this using the <em>Tools</em> submenu of the <em>World</em> menu.
</p>
<p>
<a id="SmaCCGUI"></a>
<figure>
	<img src="figures/SmaCCGUI.png" width="80%" id="SmaCCGUI" alt="SmaCC GUI Tool: The place to define the scanner and parser."/>
	<figcaption>SmaCC GUI Tool: The place to define the scanner and parser.</figcaption>
</figure>
</p>
<p>
Our first calculator is going to be relatively simple. It is going to take two numbers and add them together. 
To use the SmaCC tool:
</p><ul>
<li>Edit the definition in the pane below the buttons.</li>
<li>Once you are done:<ul>
<li>Accept (with the context menu) or Save (the button)</li>
<li>Name your parser (and scanner) by typing a name (for example, CalculatorParser) in the text field at the left of the Parser label, followed by return.</li>
</ul>
</li>
<li>press either Compiler LR(1) or Compiled LALR(1) buttons to compile the parser.</li>
</ul>

<p>
You are now ready to edit your first scanner and parser. Note that you edit everything in one file (using the SmaCC tool).
Once compiled, the tools will generate two classes and fill them with sufficient information to create the scanner and parser, as shown as Figure <a href="#SmaCCTutorial"></a>.
</p>

<h3>First, the Scanner</h3>
<p>
To start things off, we have to tell the scanner how to recognize a number. A number starts with one or more digits, possibly followed by a decimal point with zero or more digits after it. The scanner definition for this token (called a token specification) is:
</p>
<figure><pre><code>&lt;number&gt;        :       [0-9]+ (\. [0-9]*) ? ;</code></pre><figcaption></figcaption></figure>

<p>
Let's go over each part:
</p>
<dl><dt><code>&lt;number&gt;</code></dt>
<dd>Names the token identified by the token specification. The name inside the &lt;&gt; must be a legal Pharo variable name.</dd>
<dt><code>:</code></dt>
<dd>Separates the name of the token from the token's definition.</dd>
<dt><code>[0-9]</code></dt>
<dd>Matches any single character in the range <code>'0'</code> to <code>'9'</code> (a digit). We could also use <code>\d</code> or <code>&lt;isDigit&gt;</code> as these also match digits.</dd>
<dt><code>+</code></dt>
<dd>Matches the previous expression one or more times. In this case, we are matching one or more digits.</dd>
<dt><code>( ... )</code></dt>
<dd>Groups subexpressions. In this case we are grouping the decimal point and the numbers following the decimal point.</dd>
<dt><code>\.</code></dt>
<dd>Matches the '.' character (<code>.</code> has a special meaning in regular expressions; <code>\</code> quotes it).</dd>
<dt><code>*</code></dt>
<dd>Matches the previous expression zero or more times.</dd>
<dt><code>?</code></dt>
<dd>Matches the previous expression zero or one time (i.e., it is optional).</dd>
<dt><code>;</code></dt>
<dd>Terminates a token specification.</dd>
</dl>


<h4>Ignoring Whitespace</h4>
<p>
We don't want to have to worry about whitespace in our language, so we need to define what whitespace is, and tell SmaCC to ignore it. To do this, enter the following token specification on the next line:
</p>
<figure><pre><code>&lt;whitespace&gt;    :       \s+;</code></pre><figcaption></figcaption></figure>

<p>
<code>\s</code> matches any whitespace character (space, tab, linefeed, etc.). So how do we tell the scanner to ignore it? If you look in the <code>SmaCCScanner</code> class (the superclass of all the scanners created by SmaCC), you will find a method named <code>whitespace</code>. If a scanner understands a method that has the same name as a token name, that method will be executed whenever the scanner matches that kind of token. As you can see, the <code>SmaCCScanner&gt;&gt;whitespace</code> method eats whitespace. 
</p>
<figure><pre><code>SmaCCScanner &gt;&gt; whitespace
	&quot;By default, eat the whitespace&quot;

	self resetScanner.
	^ self scanForToken</code></pre><figcaption></figcaption></figure>

<p>
<code>SmaCCScanner</code> also defines a <code>comment</code> method. That method both ignores the comment token (does not create a token for the parser) and stores the interval in the source where the comment occurred in the <code>comments</code> instance variable.
</p>
<figure><pre><code>SmaCCScanner &gt;&gt; comment
	comments add: (Array with: start + 1 with: matchEnd).
	^ self whitespace</code></pre><figcaption></figcaption></figure>

<p>
The only other token that will appear in our system is the <code>+</code> token for addition. However, since this token is a constant, there is no need to define it as a token in the scanner.  Instead, we will enter it directly (as a quoted string) in the grammar rules
that define the parser.
</p>
<h3>Second, the Calculator Grammar</h3>
<p>
Speaking of the grammar, let's go ahead and define it. Enter the following specification below your two previous rules in the editor pane, as shown in Figure <a href="#SmaCCTutorial"></a>.
</p>
<figure><pre><code>Expression 
	: Expression &quot;+&quot; Number
	| Number
	;
Number 
	: &lt;number&gt;
	;</code></pre><figcaption></figcaption></figure>

<p>
This basically says that an expression is either a number, or an expression added to a number. You should now have something that looks like Figure <a href="#SmaCCTutorial"></a>.
</p>
<p>
<a id="SmaCCTutorial"></a>
<figure>
	<img src="figures/SmaCCTutorial.png" width="80%" id="SmaCCTutorial" alt="First grammar: the Scanner part followed by the Parser part."/>
	<figcaption>First grammar: the Scanner part followed by the Parser part.</figcaption>
</figure>
</p>
<h3>Compile the Scanner and the Parser</h3>
<p>
We are almost ready to compile a parser now, but first we need to specify the names of the scanner and parser classes that SmaCC will create. These names are entered using the <code>...</code> buttons for scanner class and parser class. Enter <code>CalculatorScanner</code> and <code>CalculatorParser</code> respectively. Once the class names are entered, press Compile LR(1) or Compile LALR(1). This will create new Pharo classes for the <code>CalculatorScanner</code> and <code>CalculatorParser</code>, and compile several methods in those classes. All the methods that SmaCC compiles will go into a &quot;generated&quot; method protocol. You should not change those methods or add new methods to the &quot;generated&quot; method protocols, because these methods are replaced or deleted each time you compile.
</p>
<p>
Whenever SmaCC creates new classes, they are placed in the package (or package tag) named in the Package entry box. You may wish to select a different package by selecting it in the drop down menu or writing its name.
</p>
<h3>Testing our Parser</h3>

<p>
Now we are ready to test our parser. Go to the &quot;test&quot; pane, enter <code>3 + 4</code>, and press &quot;Parse&quot;; you will see that the parser correctly parses it. If you press &quot;Parse and inspect&quot; you will see an inspector on an OrderedCollection that contains the parsed tokens, as shown in Figure <a href="#3plus4Explorer"></a>. This is because we haven't specified what the parser is supposed to do when it parses.
</p>
<p>
You can also enter incorrect items as test input. For example, try to parse <code>3 + + 4</code> or <code>3 + a</code>. An error message should appear in the text.
</p>
<p>
<a id="3plus4Explorer"></a>
<figure>
	<img src="figures/3plus4Explorer.png" width="40%" id="3plus4Explorer" alt="Inspector on 3 + 4"/>
	<figcaption>Inspector on 3 + 4</figcaption>
</figure>
</p>

<p>
If you are interested in the generated parser, you may wish to look at the output from compiling the parser in the Symbols or Item Sets tab. 
</p>
<ul>
<li>The Symbols tab lists all of the terminal and non-terminal symbols that were used in the parser. The number besides each is the internal id used by the parser.</li>
<li>The Item Sets tab lists the LR item sets that were used in the parser. These are printed in a format that is similar to the format used by many text books.</li>
<li>The Messages tab is used to display any warnings generated while the parser was compiled. The most common warning is for ambiguous actions.</li>
</ul>

<h3>Defining Actions</h3>
<p>
Now we need to define the actions that need to happen when we parse our expressions. Currently, our parser is just validating that the expression is a bunch of numbers added together. Generally, you want to create some structure that represents what you've parsed (e.g., a parse tree). However, in this case, we are not concerned about the structure, but we are concerned about the result: the <em>value</em> of the expression. For our example, we can calculate the value by modifying the grammar to be:
</p>
<figure><pre><code>Expression 
	: Expression &quot;+&quot; Number {'1' + '3'}
	| Number {'1'}
	;
Number 
	: &lt;number&gt; {'1' value asNumber}
	;</code></pre><figcaption></figcaption></figure>

<p>
The text between the braces is Pharo code that is evaluated when the grammar rule is applied. Strings that contain a number are replaced with the corresponding expression in the production. For example, in the first rule for Expression, the <code>'1'</code> will be replaced by the object that matches Expression, and the <code>'3'</code> will be replaced by the object that matches <code>Number</code>. 
The second item in the rule is the <code>&quot;+&quot;</code> token. Since we already know what it is, there is no need to refer to it by number.
</p>
<p>
Compile the new parser. Now, when you do a 'Parse and inspect' from the test pane containing <code>3 + 4</code>, you should see the result: 7.
</p>
<h3>Named Expressions</h3>
<p>
One problem with the quoted numbers in the previous example is that if you change a rule, you may also need to change the code for that rule. For example, if you inserted a new token at the beginning of the rule for Expression, then you would also need to increment all of the numeric references in the Pharo code. 
</p>
<p>
We can avoid this problem by using named expressions. After each part of a rule, we can specify its name. Names are enclosed in single quotes, and must be legal Pharo variable names. Doing this for our grammar we get:
</p>
<figure><pre><code>Expression 
	: Expression 'expression' &quot;+&quot; Number 'number' {expression + number}
	| Number 'number' {number}
	;
Number 
	: &lt;number&gt; 'numberToken' {numberToken value asNumber}
	;</code></pre><figcaption></figcaption></figure>

<p>
This will result in the same language being parsed as in the previous example, with the same actions. Using named expressions makes it much easier to maintain your parsers. 
</p>
<h3>Extending the Language</h3>

<p>
Let's extend our language to add subtraction. Here is the new grammar:
</p>
<figure><pre><code>Expression 
	: Expression 'expression' &quot;+&quot; Number 'number' {expression + number}
	| Expression 'expression' &quot;-&quot; Number 'number' {expression - number}
	| Number 'number' {number}
	;
Number 
	: &lt;number&gt; 'numberToken' {numberToken value asNumber}
	;</code></pre><figcaption></figcaption></figure>

<p>
After you've compiled this, <code>'3 + 4 - 2'</code> should return <code>'5'</code>. Next, let's add multiplication and division:
</p>
<figure><pre><code>Expression 
	: Expression 'expression' &quot;+&quot; Number 'number' {expression + number}
	| Expression 'expression' &quot;-&quot; Number 'number' {expression - number}
	| Expression 'expression' &quot;*&quot; Number 'number' {expression * number}
	| Expression 'expression' &quot;/&quot; Number 'number' {expression / number}
	| Number 'number' {number}
	;
Number 
	: &lt;number&gt; 'numberToken' {numberToken value asNumber}
	;</code></pre><figcaption></figcaption></figure>


<h3>Handling Priority</h3>

<p>
Here we run into a problem. 
If you evaluate <code>'2 + 3 * 4'</code> you end up with 20. 
The problem is that in standard arithmetic, multiplication has a higher precedence than addition. 
Our grammar evaluates strictly left-to-right. 
The standard solution for this problem is to define additional non-terminals to force the sequence of evaluation. 
Using that solution, our grammar would look like this.
</p>
<figure><pre><code>Expression  
	: Term 'term' {term}
	| Expression 'expression' &quot;+&quot; Term 'term' {expression + term}
	| Expression 'expression' &quot;-&quot; Term 'term' {expression - term}
	;
Term 
	: Number 'number' {number}
	| Term 'term' &quot;*&quot; Number 'number' {term * number}
	| Term 'term' &quot;/&quot; Number 'number' {term / number}
	;
Number 
	: &lt;number&gt; 'numberToken' {numberToken value asNumber}
	;</code></pre><figcaption></figcaption></figure>

<p>
If you compile this grammar, you will see that <code>'2 + 3 * 4'</code> evaluates to <code>'14'</code>, as you would expect. 
</p>
<h3>Handling Priority with Directives</h3>

<p>
As you can imagine, defining additional non-terminals gets pretty complicated as the number of levels of precedence increases. 
We can use ambiguous grammars and precedence rules to simplify this situation. 
Here is the same grammar using precedence to enforce our desired evaluation order:
</p>
<figure><pre><code>%left &quot;+&quot; &quot;-&quot;;
%left &quot;*&quot; &quot;/&quot;;

Expression 
	: Expression 'exp1' &quot;+&quot; Expression 'exp2' {exp1 + exp2}
	| Expression 'exp1' &quot;-&quot; Expression 'exp2' {exp1 - exp2}
	| Expression 'exp1' &quot;*&quot; Expression 'exp2' {exp1 * exp2}
	| Expression 'exp1' &quot;/&quot; Expression 'exp2' {exp1 / exp2}
	| Number 'number' {number}
	;
Number 
	: &lt;number&gt; 'numberToken' {numberToken value asNumber}
	;</code></pre><figcaption></figcaption></figure>

<p>
Notice that we changed the grammar so that there are Expressions on both sides of the operator. 
This makes the grammar ambiguous: an expression like <code>'2 + 3 * 4'</code> can be parsed in two ways.  
This ambiguity is resolved using SmaCC's precedence rules.
</p>
<p>
The two lines that we added to the top of the grammar mean that <code>+</code> and <code>-</code> are evaluated left-to-right and have the same precedence. 
Likewise, the second line means that <code>*</code> and <code>/</code> are evaluated left-to-right and have equal precedence.
Because the rule for <code>+</code> and <code>-</code> comes first, <code>+</code> and <code>-</code> have lower precedence than <code>*</code> and <code>/</code>.
Grammars using precedence rules are usually much more intuitive, especially in cases with many precedence levels.
Just as an example, let's add exponentiation and parentheses. 
Here is our final grammar:
</p>
<figure><pre><code>&lt;number&gt; : [0-9]+ (\. [0-9]*) ? ;
&lt;whitespace&gt; : \s+;
%left &quot;+&quot; &quot;-&quot;;
%left &quot;*&quot; &quot;/&quot;;
%right &quot;^&quot;;

Expression 
	: Expression 'exp1' &quot;+&quot; Expression 'exp2' {exp1 + exp2}
	| Expression 'exp1' &quot;-&quot; Expression 'exp2' {exp1 - exp2}
	| Expression 'exp1' &quot;*&quot; Expression 'exp2' {exp1 * exp2}
	| Expression 'exp1' &quot;/&quot; Expression 'exp2' {exp1 / exp2}
	| Expression 'exp1' &quot;^&quot; Expression 'exp2' {exp1 raisedTo: exp2}
	| &quot;(&quot; Expression 'expression' &quot;)&quot; {expression}
	| Number 'number' {number}
	;
Number 
	: &lt;number&gt; 'numberToken' {numberToken value asNumber}
	;</code></pre><figcaption></figcaption></figure>

<p>
Once you have compiled the grammar, you will be able to evaluate <code>3 + 4 * 5 ^ 2 ^ 2</code> to get 2503.
Since the exponent operator <code>^</code> is defined to be right associative, this expression is evaluated as <code>3 + (4 * (5 ^ (2 ^ 2)))</code>.
We can also evaluate expressions with parentheses.
For example, evaluating <code>(3 + 4) * (5 - 2) ^ 3</code> results in 189.
</p>
<p>
The sections that follow provide more information on  SmaCC's scanner and parser, and on the directives that control SmaCC.
</p>
<p>
Subsequent sections explain how SmaCC can automatically produce an AST for you and how to use the Rewrite Engine.

</p>

  </section>

</article>

<footer>

<div class="footline">
    <div class="github-link">
      <a href="" target="blank"><i class="fa fa-code-fork"></i>Github</a>
    </div>
  </div>
</footer>

<script src="/booklet-Smacc/html/_support/html/js/clipboard.min.js"></script>

<link href="/booklet-Smacc/html/_support/html/css/featherlight.min.css" rel="stylesheet">
<script src="/booklet-Smacc/html/_support/html/js/featherlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script src="/booklet-Smacc/html/_support/html/js/flex.js"></script>
<!-- Prettify annotated paragraphs-->
    <script src="/booklet-Smacc/html_support/html/js/annotated-paragraphs.js"></script>

  </body>
</html>
